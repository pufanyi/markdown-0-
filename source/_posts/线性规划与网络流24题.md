---
title: çº¿æ€§è§„åˆ’ä¸ç½‘ç»œæµ24é¢˜
tags:
 - ç½‘ç»œæµ
---

$Loj$ä¸Šå»æ‰äº†ä¸€é¢˜ï¼šæœºå™¨äººè·¯å¾„è§„åˆ’é—®é¢˜ï¼Œæ‰€ä»¥å°±ä¸åšå•¦ã€‚

[ç½‘ç»œæµ24(23)é¢˜é¢˜é¢](https://loj.ac/problems/search?keyword=%E7%BD%91%E7%BB%9C%E6%B5%81+24+%E9%A2%98)

<!--more-->

[TOC]



# é¢˜è§£

## æ­é…é£è¡Œå‘˜

â€‹	é¢˜è§£ï¼š**ç½‘ç»œæœ€å¤§æµ**

â€‹	äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ï¼Œå¯ä»¥ç”¨å®¹æ˜“å®ç°çš„$Hungary$ç®—æ³•$O(n^3/n(m+n)$ï¼Œä¹Ÿå¯ä»¥ç”¨ç½‘ç»œæµå»ºå›¾ï¼Œç”¨$Dinic$è·‘äºŒåˆ†å›¾çš„å¤æ‚åº¦æ˜¯$O(\sqrt n*m)$åˆ«é—®æˆ‘ä¸ºä»€ä¹ˆã€‚

â€‹	æ–°å»ºæºç‚¹Sï¼Œæ±‡ç‚¹Tï¼Œä»Så‘æ¯ä¸ªæ­£é©¾é©¶è¿ä¸€æ¡å®¹é‡ä¸º1çš„è¾¹ï¼Œæ¯ä¸ªå‰¯é©¾é©¶å‘Tè¿ä¸€æ¡å®¹é‡ä¸º1çš„è¾¹ï¼Œå¯¹äºæ¯ä¸ªå¯ä»¥åŒ¹é…çš„æ­£é©¾é©¶å’Œå‰¯é©¾é©¶ï¼Œä»æ­£é©¾é©¶å‘å‰¯é©¾é©¶è¿ä¸€æ¡å®¹é‡ä¸º1çš„è¾¹ï¼Œè·‘å‡ºæ¥çš„æœ€å¤§æµå°±æ˜¯ç­”æ¡ˆã€‚

## å¤ªç©ºé£è¡Œè®¡åˆ’

â€‹	é¢˜è§£ï¼š**ç½‘ç»œæœ€å°å‰²**

â€‹	ä¸å¦¨å‡è®¾å…¨éƒ¨æ”¶ç›Šéƒ½å¾—åˆ°ï¼Œè€Œä¸èŠ±è´¹è´¹ç”¨ã€‚æ–°å»ºæºç‚¹Sï¼Œæ±‡ç‚¹Tã€‚

â€‹	ä»Så‘æ¯ä¸ªå®éªŒè¿ä¸€æ¡å®¹é‡ä¸ºæ”¶ç›Šçš„è¾¹ï¼Œæ¯ä¸ªå®éªŒå‘å™¨æ¢°è¿ä¸€æ¡å®¹é‡ä¸º$inf$çš„è¾¹ï¼Œæ¯ä¸ªå™¨æ¢°å‘ Tè¿ä¸€æ¡å®¹é‡ä¸ºè´­ä¹°è´¹ç”¨çš„è¾¹ã€‚

â€‹	æ­¤æ—¶æ±‚æœ€å°å‰²ï¼Œå¦‚æœåœ¨Sé›†ï¼Œè¯´æ˜è¿™ä¸ªå®éªŒåšï¼Œå¦‚æœåœ¨Té›†ï¼Œè¯´æ˜è¿™ä¸ªå®éªŒä¸åšã€‚

â€‹	æ˜¾ç„¶ï¼Œå®¹é‡ä¸º$inf$çš„è¾¹ä¸èƒ½è¢«å‰²å»ï¼Œæ‰€ä»¥å¦‚æœåœ¨Sé›†ï¼Œå¿…é¡»æ»¡è¶³å³è¾¹å…¨éƒ¨çš„å®éªŒå™¨æéƒ½ä¹°äº†ã€‚é‚£ä¹ˆS-æœ€å°å‰²å°±æ˜¯ç­”æ¡ˆã€‚ï¼ˆæœ€å°å‰²=æœ€å¤§æµï¼Œè¯æ˜è§ç®—å¯¼æˆ–ç›¸å…³è®ºæ–‡ï¼‰

## æœ€å°è·¯å¾„è¦†ç›–

â€‹	é¢˜è§£ï¼š**ç½‘ç»œæœ€å¤§æµ**

â€‹	æ–°å»ºæºç‚¹Sï¼Œæ±‡ç‚¹Tã€‚

â€‹	æˆ‘ä»¬æŠŠæ¯ä¸ªç‚¹æ‹†æˆä¸¤ä¸ªç‚¹$i_1$å’Œ$i_2$ï¼Œå¯¹äºè¾¹$i->j$ï¼Œè¿ä¸€æ¡$i_1->j_2$,å®¹é‡ä¸º1çš„è¾¹ï¼Œå¯¹äºæ¯ä¸ªç‚¹ï¼Œè¿$S$åˆ°$i_1$å®¹é‡ä¸º1çš„è¾¹ï¼Œè¿$i_2$åˆ°Tå®¹é‡ä¸º1çš„è¾¹ã€‚

â€‹	æ­¤æ—¶æ±‚æœ€å¤§æµï¼Œå¦‚æœæµè¿‡ä¸€æ¡$i_1$åˆ°$j_2$çš„è¾¹ï¼Œè¯´æ˜å¯ä»¥æŠŠä»¥$i$ç»“å°¾çš„ç‚¹å’Œä»¥$j$å¼€å¤´çš„ä¸¤æ¡è·¯å¾„åˆå¹¶èµ·æ¥ï¼Œå˜æˆä¸€æ¡è·¯å¾„ã€‚è€Œç­”æ¡ˆè¦æœ€å°è·¯å¾„è¦†ç›–ï¼Œä¹Ÿå°±æ˜¯æ€»ç‚¹æ•°-åˆå¹¶çš„æ¬¡æ•°ï¼ˆæœ€å¤§æµï¼‰ã€‚

â€‹	å› ä¸ºæ˜¯DAGï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°ç¯ã€‚

## é­”æœ¯çƒé—®é¢˜

â€‹	é¢˜è§£ï¼š**ç½‘ç»œæœ€å¤§æµ**

â€‹	å¦‚æœæˆ‘ä»¬å·²çŸ¥ç­”æ¡ˆ$Ans$ï¼Œè¦åˆ¤æ–­æ”¾1~Ansæœ€å°‘è¦å‡ æ ¹æŸ±å­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š

â€‹	å¯¹äºæ¯ä¸ªæ•°å­—$i$ï¼Œå¦‚æœå­˜åœ¨$j$ï¼Œæ»¡è¶³$j>i$ï¼Œå¹¶ä¸”$i+j$æ˜¯å®Œå…¨å¹³æ–¹æ•°ï¼Œé‚£ä¹ˆä»$i$åˆ°$j$è¿ä¸€æ¡è¾¹ï¼Œè¿å®Œä¹‹åæ˜¾ç„¶è¿™æ˜¯ä¸€ä¸ªDAGï¼Œæ±‚å‡ºæœ€å°è·¯å¾„è¦†ç›–å°±æ˜¯éœ€è¦çš„æŸ±å­ï¼ˆåšæ³•åŒæœ€å°è·¯å¾„è¦†ç›–ï¼‰

â€‹	é‚£ä¹ˆè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥äºŒåˆ†ç­”æ¡ˆç„¶ååˆ¤å®šï¼Œä½†æ˜¯åŸºäºæ®‹é‡ç½‘ç»œçš„ä¼˜ç§€æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æšä¸¾ç­”æ¡ˆï¼Œå¯¹äºä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œé‡æ–°åŠ å…¥ç›¸å…³è¾¹ï¼Œå¹¶åœ¨æ®‹é‡ç½‘ç»œä¸Šè·‘æœ€å¤§æµã€‚åˆ°æšä¸¾åˆ°ç¬¬ä¸€ä¸ªä¸å¯è¡Œçš„$Ans$ï¼Œç­”æ¡ˆå°±æ˜¯$Ans-1$

â€‹	è¾“å‡ºæ–¹æ¡ˆçš„æ—¶å€™åˆ æ‰æœ€åä¸¤ä¸ªç‚¹ï¼Œé‡æ–°è·‘æœ€å¤§æµï¼ˆæˆ–è€…åˆ é™¤ç›¸å…³å®¹é‡ï¼‰ã€‚

## åœ†æ¡Œèšé¤

â€‹	é¢˜è§£ï¼š**ç½‘ç»œæœ€å¤§æµ**

â€‹	æ–°å»ºæºç‚¹Sï¼Œæ±‡ç‚¹Tã€‚

â€‹	ä»Såˆ°æ¯ä¸ªå•ä½å®¹é‡ä¸º$r_i$çš„è¾¹ï¼Œä»åœ†æ¡Œå‘Tè¿ä¸€æ¡å®¹é‡ä¸º$C_i$çš„è¾¹ï¼Œæ¯ä¸ªå•ä½å‘æ¯ä¸ªåœ†æ¡Œè¿ä¸€æ¡å®¹é‡ä¸º$i$çš„è¾¹ã€‚

â€‹	è·‘æœ€å¤§æµåçœ‹å“ªäº›è¾¹è¢«æµè¿‡å³å¯ã€‚

## æœ€é•¿é€’å¢å­åºåˆ—

â€‹	é¢˜è§£ï¼š**ç½‘ç»œæœ€å¤§æµ**

â€‹	æ³¨æ„é¢˜ç›®æ˜¯éä¸¥æ ¼é€’å¢QAQã€‚

â€‹	ç¬¬ä¸€é—®æ˜¯ç»å…¸çš„DPï¼ˆå¯ä»¥ç”¨$O(n^2)$åšæ³•æ°´ï¼‰ï¼Œæ­¤æ—¶å¾—åˆ°$dp$æ•°ç»„$f[i]$è¡¨ç¤º$i$ç»“å°¾çš„æœ€é•¿

â€‹	ç¬¬äºŒé—®å¯ä»¥æŠŠæ¯ä¸ªç‚¹æ‹†ç‚¹ï¼Œé™åˆ¶æµé‡ä¸è¶…è¿‡1ï¼ˆä»å…¥ç‚¹åˆ°å‡ºç‚¹å®¹é‡ä¸º1çš„è¾¹ï¼‰ï¼Œä»Så‘$f[i]$ä¸º1çš„å…¥ç‚¹å®¹é‡ä¸º1çš„è¾¹ï¼Œä»$f[i]$ä¸º$ans$çš„å‡ºç‚¹è¾¹å‘Tè¿ä¸€æ¡å®¹é‡ä¸º1çš„è¾¹ã€‚

â€‹	å¯¹äºå¯ä»¥è½¬ç§»çš„ï¼Œå¹¶ä¸”$f[i]+1=f[j](i<j,a[i]<=a[j])$ï¼Œä»içš„å‡ºç‚¹å‘jçš„å…¥ç‚¹ä¸€æ¡å®¹é‡ä¸º1çš„è¾¹ï¼Œç„¶åè·‘ç½‘ç»œæœ€å¤§æµå³å¯ã€‚

â€‹	å¯¹äºç¬¬ä¸‰é—®ï¼Œåªéœ€è¦æŠŠ1å’Œnçš„å®¹é‡é™åˆ¶åŠ ä¸Š$inf$å³å¯ã€‚æ­¤æ—¶å†è·‘ç½‘ç»œæœ€å¤§æµå³å¯ã€‚

## è¯•é¢˜åº“

â€‹	é¢˜è§£ï¼š**ç½‘è·¯æœ€å¤§æµ**

â€‹	æ–°å»ºæºç‚¹Sï¼Œæ±‡ç‚¹Tã€‚

â€‹	è¯•é¢˜å‘ç±»å‹å»ºå®¹é‡ä¸º1 çš„è¾¹ï¼Œæºç‚¹Så‘è¯•é¢˜è¿å®¹é‡ä¸º1çš„è¾¹ï¼Œç±»å‹å‘æ±‡ç‚¹Tè¿å®¹é‡ä¸ºéœ€è¦é¢˜æ•°çš„è¾¹ï¼Œè·‘ç½‘ç»œæœ€å¤§æµçœ‹æ˜¯å¦æ»¡æµã€‚

â€‹	è¾“å‡ºæ–¹æ¡ˆçœ‹å“ªäº›è¯•é¢˜å‘ç±»å‹çš„è¾¹è¢«æµè¿‡ã€‚

## æ–¹æ ¼å–æ•°

â€‹	é¢˜è§£ï¼š**ç½‘ç»œæœ€å°å‰²**

â€‹	é¦–å…ˆå¯¹ç½‘æ ¼è¿›è¡Œé»‘ç™½æŸ“è‰²ã€‚

â€‹	ç„¶åå‡è®¾å¾—åˆ°äº†æ‰€æœ‰ç­”æ¡ˆã€‚

â€‹	æ–°å»ºæºç‚¹Sï¼Œæ±‡ç‚¹Tï¼Œä»Så‘æ‰€æœ‰ç™½è‰²æ ¼å­è¿ä¸€æ¡å®¹é‡ä¸ºå…¶å€¼çš„è¾¹ï¼Œæ‰€æœ‰é»‘è‰²æ ¼å­å‘Tè¿ä¸€æ¡å®¹é‡ä¸ºå…¶å€¼çš„è¾¹ï¼Œæ‰€æœ‰ç™½è‰²æ ¼å­å‘å…¶ç›¸é‚»çš„é»‘è‰²æ ¼å­è¿ä¸€æ¡å®¹é‡ä¸º$inf$çš„è¾¹ï¼Œå®¹æ˜“å‘ç°æ­¤æ—¶æ±‚æœ€å°å‰²å³æœ€å°‘å‡å°‘çš„ç­”æ¡ˆâ€”â€”å¦‚æœè¦é€‰ä¸€ä¸ªç™½è‰²æ ¼å­ï¼Œå¿…é¡»ä¿è¯å…¶ç›¸é‚»çš„é»‘è‰²æ ¼å­ä¸é€‰ï¼ˆå‰²æ‰ï¼‰ï¼Œé€‰é»‘è‰²æ ¼å­åŒç†ã€‚

## é¤å·¾è®¡åˆ’

â€‹	é¢˜è§£ï¼š**æœ‰ä¸Šä¸‹ç•Œçš„æœ€å°è´¹ç”¨æµ**

â€‹	æŠŠæ¯å¤©æ‹†ç‚¹ï¼Œå®šä¹‰ä¸ºå…¥ç‚¹å’Œå‡ºç‚¹ã€‚

â€‹	ä»å…¥ç‚¹åˆ°å‡ºç‚¹è¿ä¸€æ¡ä¸Šä¸‹ç•Œå®¹é‡éƒ½ä¸ºå½“å¤©éœ€è¦æ¯›å·¾ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ï¼Œè¡¨ç¤ºè¿™å¤©ä½¿ç”¨äº†è¿™ä¹ˆå¤šæ¯›å·¾ã€‚

â€‹	ä»Så‘æ‰€æœ‰å…¥ç‚¹è¿ä¸€æ¡å®¹é‡ä¸º$inf$ï¼Œè´¹ç”¨ä¸ºè´­ä¹°æ–°æ¯›å·¾çš„ä»·æ ¼ï¼Œè¡¨ç¤ºæ¯å¤©éƒ½å¯ä»¥æ–°è´­å…¥æ¯›å·¾ã€‚â€”â€”æ­¤å¤„å»ºå›¾ä¹Ÿå¯ä»¥å…¨éƒ¨ç¬¬ä¸€å¤©ä¹°ã€‚

â€‹	ä»æ¯å¤©çš„å…¥ç‚¹å‘ä¸‹ä¸€å¤©ï¼ˆå¦‚æœæœ‰ï¼‰çš„å…¥ç‚¹è¿ä¸€æ¡å®¹é‡ä¸º$inf$ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ï¼Œè¡¨ç¤ºå‰ä¸€å¤©æ²¡ç”¨è¿‡çš„ä¸‹ä¸€å¤©è¿˜èƒ½ç”¨ã€‚

â€‹	ä»æ¯å¤©çš„å‡ºç‚¹å‘æ…¢æ´—åé‚£å¤©çš„å…¥ç‚¹è¿ä¸€æ¡å®¹é‡ä¸º$inf$ï¼Œè´¹ç”¨ä¸ºæ…¢æ´—çš„ä»·æ ¼çš„è¾¹ã€‚

â€‹	ä»æ¯å¤©çš„å‡ºç‚¹å‘å¿«æ´—åé‚£å¤©çš„å…¥ç‚¹è¿ä¸€æ¡å®¹é‡ä¸º$inf$ï¼Œè´¹ç”¨ä¸ºå¿«æ´—çš„ä»·æ ¼çš„è¾¹ã€‚

â€‹	ä»æ¯ä¸€å¤©çš„å‡ºç‚¹å‘Tè¿ä¸€æ¡è¾¹ï¼Œè¡¨ç¤ºç”¨è¿‡äº†æ‰”äº†ã€‚

â€‹	æ­¤æ—¶è·‘ä¸Šä¸‹ç•Œæœ€å°è´¹ç”¨æœ€å¤§æµå³å¯ã€‚ï¼ˆæ˜¾ç„¶æœ‰è§£ï¼‰

## è½¯ä»¶è¡¥ä¸

â€‹	é¢˜è§£ï¼š**çŠ¶æ€å‹ç¼©,æœ€çŸ­è·¯**

â€‹	æŠŠæ‹¥æœ‰bugå‹ç¼©æˆä¸€ä¸ªäºŒè¿›åˆ¶çŠ¶æ€ï¼Œä¾æ¬¡åˆ¤æ–­mæ¡å¯å¦è½¬ç§»ï¼ˆå¯ä»¥ä¸æ˜¾ç¤ºå»ºå›¾ï¼‰ã€‚ç±»ä¼¼äºæœ€çŸ­è·¯åšæ³•ï¼Œæ—¶é—´å¤æ‚åº¦$O(2^nm)$

## æ•°å­—æ¢¯å½¢

â€‹	é¢˜è§£ï¼š**æœ€å¤§è´¹ç”¨æœ€å¤§æµ**

â€‹	PSï¼šè¿™æ˜¯ä¸€ä¸ªç­‰è…°æ¢¯å½¢

â€‹	å¯¹äºç¬¬ä¸€é—®ã€‚

â€‹	å¯¹æ¯ä¸ªç‚¹æ‹†ç‚¹ï¼Œä¸­é—´è¿ä¸€æ¡å®¹é‡ä¸º1ï¼Œè´¹ç”¨ä¸ºå…¶å€¼çš„è¾¹ï¼ˆå®ç°å¯ä»¥ç”¨å…¶å€¼çš„ç›¸åæ•°ï¼‰

â€‹	ä»æºç‚¹Så‘ç¬¬ä¸€å±‚çš„æ¯ä¸€ä¸ªç‚¹è¿ä¸€æ¡å®¹é‡ä¸º1ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ã€‚

â€‹	å¯¹äºæ¯ä¸ªç‚¹çš„å‡ºç‚¹ï¼Œå‘å®ƒå·¦ä¸‹è§’å’Œå³ä¸‹è§’çš„ç‚¹çš„å…¥ç‚¹è¿ä¸€æ¡å®¹é‡ä¸º1ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ã€‚

â€‹	ä»æœ€åä¸€å±‚çš„å‡ºç‚¹å‘Tç‚¹è¿ä¸€æ¡å®¹é‡ä¸º$inf$ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ã€‚

â€‹	æ­¤æ—¶æ±‚æœ€å¤§è´¹ç”¨æœ€å¤§æµï¼Œå³ä¸ºæ‰€è¦ç»“æœ

â€‹	å¯¹äºç¬¬äºŒé—®ï¼Œåœ¨ç¬¬ä¸€é—®åŸºç¡€ä¸Šåªéœ€è¦å°†æ¯ä¸ªç‚¹æ‹†å¼€çš„ä¸­é—´å®¹é‡ä¸º$inf$å³å¯ã€‚

â€‹	å¯¹äºç¬¬ä¸‰é—®ï¼Œåœ¨ç¬¬äºŒé—®åŸºç¡€ä¸Šåªéœ€è¦å°†åˆ°å·¦ä¸‹è§’ï¼Œå³ä¸‹è§’çš„è¾¹çš„å®¹é‡æ”¹æˆ(å¢åŠ )$inf$å³å¯ã€‚

## è¿è¾“é—®é¢˜

â€‹	é¢˜è§£ï¼š**æœ€å°è´¹ç”¨æœ€å¤§æµ,æœ€å¤§è´¹ç”¨æœ€å¤§æµ**

â€‹	æ–°å»ºæºç‚¹Sï¼Œæ±‡ç‚¹Tã€‚

â€‹	ä»æºç‚¹Såˆ°æ‰€æœ‰ä»“åº“ä¸€æ¡å®¹é‡ä¸º$a_i$è´¹ç”¨ä¸º0çš„è¾¹ï¼Œä»æ‰€æœ‰å•†åº—åˆ°æ±‡ç‚¹å®¹é‡ä¸º$b_j$è´¹ç”¨ä¸º0çš„è¾¹ã€‚ä»æ¯ä¸ªä»“åº“åˆ°æ¯ä¸ªå•†åº—è¿ä¸€æ¡å®¹é‡ä¸º$inf$,è´¹ç”¨ä¸º$c[i]$çš„è¾¹ï¼Œè·‘æœ€å°è´¹ç”¨æœ€å¤§æµå’Œæœ€å¤§è´¹ç”¨æœ€å¤§æµï¼ˆåªéœ€è¦æŠŠè¾¹å–åï¼Œå†ç­”æ¡ˆå–åå³å¯ï¼‰

## åˆ†é…é—®é¢˜

â€‹	é¢˜è§£ï¼š**æœ€å°è´¹ç”¨æœ€å¤§æµ,æœ€å¤§è´¹ç”¨æœ€å¤§æµ**

â€‹	æ–°å»ºæºç‚¹Sï¼Œæ±‡ç‚¹Tã€‚

â€‹	ä»æºç‚¹Såˆ°æ‰€æœ‰ä»“åº“ä¸€æ¡å®¹é‡ä¸º1è´¹ç”¨ä¸º0çš„è¾¹ï¼Œä»æ‰€æœ‰å•†åº—åˆ°æ±‡ç‚¹å®¹é‡ä¸º1è´¹ç”¨ä¸º0çš„è¾¹ã€‚ä»ç¬¬$i$ä¸ªä»“åº“åˆ°ç¬¬$j$ä¸ªå•†åº—è¿ä¸€æ¡å®¹é‡ä¸º1,è´¹ç”¨ä¸º$c[i][j]$çš„è¾¹ï¼Œè·‘æœ€å°è´¹ç”¨æœ€å¤§æµå’Œæœ€å¤§è´¹ç”¨æœ€å¤§æµï¼ˆåªéœ€è¦æŠŠè¾¹å–åï¼Œå†ç­”æ¡ˆå–åå³å¯ï¼‰

## è´Ÿè½½å¹³è¡¡

â€‹	é¢˜è§£ï¼š**æœ€å°è´¹ç”¨æœ€å¤§æµ**

â€‹	å°†æ¯ä¸ªæ•°éƒ½å‡å»å¹³å‡æ•°ï¼Œå¾—åˆ°Aæ•°ç»„ã€‚

â€‹	å¯¹äº$A[i]>0$çš„ï¼Œä»Så‘$i$è¿ä¸€æ¡å®¹é‡ä¸º$A[i]$çš„è¾¹ï¼Œå¦åˆ™ä»$i$å‘Tè¿ä¸€æ¡å®¹é‡ä¸º$-A[i]$çš„è¾¹

â€‹	æ¯ä¸ªç‚¹å‘ç›¸é‚»çš„ä¸¤ä¸ªç‚¹ï¼ˆæ³¨æ„æ˜¯ç¯ï¼‰è¿å®¹é‡ä¸º$inf$ï¼Œè´¹ç”¨ä¸º1çš„è¾¹ã€‚

â€‹	è·‘æœ€å°è´¹ç”¨æœ€å¤§æµå³æ˜¯ç­”æ¡ˆã€‚

## æœ€é•¿ k å¯é‡åŒºé—´é›†

â€‹	é¢˜è§£ï¼š**æœ€å¤§è´¹ç”¨æœ€å¤§æµ**

â€‹	é¦–å…ˆç¦»æ•£åŒ–ã€‚

â€‹	å®šä¹‰$w[i] = r[i]-l[i]$è¡¨ç¤ºé€‰æ‹©è¿™æ¡çº¿æ®µçš„æ”¶ç›Šã€‚

â€‹	å¯¹äºæ¯ä¸ªç‚¹ï¼Œä»$i$åˆ°$i+1$è¿ä¸€æ¡å®¹é‡ä¸º$inf$ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ã€‚

â€‹	ä»Så‘ç¬¬ä¸€ä¸ªç‚¹è¿ä¸€æ¡å®¹é‡ä¸º$K$ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ã€‚

â€‹	ä»æœ€åä¸€ä¸ªç‚¹å‘Tè¿ä¸€æ¡å®¹é‡ä¸º$K$ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ã€‚

â€‹	å¯¹äºæ¯æ¡çº¿æ®µï¼Œä»$l[i]$åˆ°$r[i]$è¿ä¸€æ¡å®¹é‡ä¸º1ï¼Œè´¹ç”¨ä¸º$w[i]$çš„è¾¹ã€‚

â€‹	æ­¤æ—¶è·‘Såˆ°Tçš„æœ€å¤§è´¹ç”¨æœ€å¤§æµå°±æ˜¯ç­”æ¡ˆã€‚

â€‹	æ¯æ¡å¢å¹¿è·¯æ˜¯å•å‘çš„ï¼Œä¼šç»è¿‡è‹¥å¹²çº¿æ®µåˆ°è¾¾Tï¼Œæ¯ä¸ªç‚¹æœ€å¤šåªç»è¿‡Kæ¬¡ã€‚

## æœ€é•¿kå¯é‡çº¿æ®µé›†é—®é¢˜

â€‹	é¢˜è§£ï¼š**æœ€å¤§è´¹ç”¨æœ€å¤§æµ**

â€‹	åšæ³•åŒä¸Šï¼Œå®šä¹‰$w[i] = dist(Segment)$ï¼Œæ³¨æ„æ˜¯å¼€çº¿æ®µã€‚

â€‹	ç”±äºå¯èƒ½æœ‰å’Œyè½´å¹³è¡Œçš„çº¿æ®µï¼Œä½œä¸€ä¸‹å¤„ç†ï¼š

â€‹	å¯¹äºæ¯ä¸ª$l[i]$,$r[i]$éƒ½ä¹˜ä¸Š2ã€‚

â€‹	å¦‚æœ$l[i]=r[i]$ï¼Œé‚£ä¹ˆ$l[i]-1$ï¼Œå¦åˆ™$l[i]+1$

â€‹	æ³¨æ„åˆ°è¿™æ ·çš„è¯ä¸ä¼šå¯¹å…¶å®ƒçº¿æ®µé€ æˆå½±å“ï¼Œè€Œä¸”è¿™ä¸ªç‚¹ä¹Ÿæœ€å¤šKæ¬¡ã€‚

## æ˜Ÿé™…è½¬ç§»

â€‹	é¢˜è§£ï¼š**ç½‘ç»œæœ€å¤§æµ**

â€‹	æšä¸¾ç­”æ¡ˆï¼Œå¯¹äºå°äºç­‰äºç­”æ¡ˆçš„æ¯ä¸ªæ—¶åˆ»ï¼Œå»ºç«‹é‚£ä¸ªæ—¶å€™çš„åœ°çƒï¼Œå„ç©ºé—´ç«™ï¼Œæœˆçƒè¿™äº›ç‚¹ã€‚

â€‹	ä»Så‘0æ—¶åˆ»çš„åœ°çƒè¿ä¸€æ¡å®¹é‡ä¸ºkçš„è¾¹ã€‚

â€‹	ä»ä¸Šä¸€ä¸ªæ—¶åˆ»çš„ç‚¹å‘è¿™ä¸ªæ—¶åˆ»è¿ä¸€æ¡å®¹é‡ä¸º$inf$çš„è¾¹ï¼Œè¡¨ç¤ºå¯ä»¥æ»ç•™ã€‚

â€‹	ä»ä¸Šä¸€ä¸ªæ—¶åˆ»å¤ªç©ºèˆ¹æ‰€åœ¨ä½ç½®çš„ç‚¹å‘è¿™ä¸ªæ—¶åˆ»å¤ªç©ºèˆ¹æ‰€åœ¨ä½ç½®çš„ç‚¹è¿ä¸€æ¡å®¹é‡ä¸º$H[i]$çš„è¾¹è¡¨ç¤ºå¯ä»¥è½¬ç§»ã€‚

â€‹	ä»æ¯ä¸ªæ—¶åˆ»çš„æœˆçƒå‘Tè¿ä¸€æ¡å®¹é‡ä¸º$inf$çš„è¾¹ï¼Œè¡¨ç¤ºç™»æœˆå°±ç»“æŸã€‚

â€‹	å¦‚æœæ»¡æµï¼Œè¯´æ˜ç­”æ¡ˆå¯è¡Œï¼Œè¾“å‡ºã€‚

â€‹	å¦‚æœ(k+2)*(n+2)æ¬¡åè¿˜ä¸è¡Œè¯´æ˜ä¸å¯è¡Œï¼ˆæˆ–è€…ç”¨å¹¶æŸ¥é›†å•ç‹¬åˆ¤æ–­æ˜¯å¦è”é€šï¼‰

## å­¤å²›è¥æ•‘é—®é¢˜

â€‹	é¢˜è§£ï¼š**çŠ¶æ€å‹ç¼©,æœ€çŸ­è·¯**

â€‹	æ³¨æ„é’¥åŒ™ğŸ”‘æ•°é‡$<=10$æ‰€ä»¥ç”¨ä¸€ä¸ªäºŒè¿›åˆ¶è¡¨ç¤ºæœ‰å“ªäº›é’¥åŒ™ï¼Œç„¶åè·‘åˆ†å±‚å›¾BFSå¾—åˆ°æœ€çŸ­è·¯å³å¯ã€‚

## èˆªç©ºè·¯çº¿é—®é¢˜

â€‹	é¢˜è§£ï¼š**æœ€å¤§è´¹ç”¨æœ€å¤§æµ**

â€‹	æŠŠæ¯ä¸ªåŸå¸‚æ‹†ç‚¹ï¼Œ1å·èŠ‚ç‚¹å’Œnå·èŠ‚ç‚¹ä¹‹é—´å…¥ç‚¹å’Œå‡ºç‚¹è¿å®¹é‡ä¸º2ï¼Œè´¹ç”¨ä¸º1çš„è¾¹ï¼Œå…¶å®ƒèŠ‚ç‚¹è¿å®¹é‡ä¸º1è´¹ç”¨ä¸º1çš„è¾¹ã€‚å¯¹äºå¯ä»¥åˆ°è¾¾çš„ï¼Œä»å‡ºç‚¹åˆ°å…¥ç‚¹è¿å®¹é‡ä¸º1ï¼ˆå¦‚æœæ˜¯1å·ç‚¹åˆ°nå·ç‚¹ï¼Œè¿å®¹é‡ä¸º2ï¼‰ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ã€‚

â€‹	ä»1å·ç‚¹çš„å…¥ç‚¹åˆ°nå·ç‚¹çš„å‡ºç‚¹è·‘æœ€å¤§è´¹ç”¨æœ€å¤§æµï¼Œå…¶å®å°±æ˜¯è·‘å‡ºä¸¤æ¡è·¯å¾„ã€‚

â€‹	è¾“å‡ºæ–¹æ¡ˆå¯ä»¥é¡ºç€å“ªäº›è¢«æµè¿‡çš„è¾¹ï¼Œæ­£ç€å€’ç€åšä¸€ä¸‹ã€‚

## æ±½è½¦åŠ æ²¹è¡Œé©¶é—®é¢˜

â€‹	é¢˜è§£ï¼š**æœ€çŸ­è·¯**

â€‹	æ³¨æ„åˆ°$k<=10$ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªèŠ‚ç‚¹$(i,j,k)$è¡¨ç¤ºåœ¨ä½ç½®$(i,j)$ï¼Œå…¶å‰©ä½™æ²¹é‡ä¸º$k$ï¼Œé‚£ä¹ˆä»ä¸€ä¸ªç‚¹å‘å‘¨å›´çš„ç‚¹ï¼Œ$(x,y,k-1)$è¿è¾¹ã€‚

â€‹	å¦‚æœåˆ°è¾¾çš„å“ªä¸ªç‚¹æ˜¯åŠ æ²¹ç«™ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯$(i,j,æ»¡æ²¹)$è¿è¾¹ã€‚

â€‹	æ­¤æ—¶æ±‚$(1,1,æ»¡æ²¹)$åˆ°$(n,n,0~æ»¡æ²¹)$çš„æœ€çŸ­è·¯å³å¯ã€‚

## æ·±æµ·æœºå™¨äººé—®é¢˜

â€‹	é¢˜è§£ï¼š**æœ€å¤§è´¹ç”¨æœ€å¤§æµ**

â€‹	æ–°å»ºæºç‚¹Sï¼Œæ±‡ç‚¹Tï¼Œæ¯ä¸ªç‚¹å‘å³è¾¹ï¼Œä¸‹é¢çš„ç‚¹è¿2æ¡è¾¹ï¼Œç¬¬ä¸€æ¡å®¹é‡ä¸º1ï¼Œè´¹ç”¨ä¸ºä»·å€¼ï¼Œç¬¬äºŒæ¡å®¹é‡ä¸º$inf$ï¼Œè´¹ç”¨ä¸º0ï¼ŒSåˆ°å¯ä»¥è¿›å…¥ç‚¹å®¹é‡ä¸º1ï¼Œè´¹ç”¨ä¸º0ï¼Œå¯å‡ºå»åˆ°Tä¸€æ¡å®¹é‡ä¸º1ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ï¼Œè·‘Såˆ°Tçš„æœ€å¤§è´¹ç”¨æœ€å¤§æµå³å¯ã€‚

## ç«æ˜Ÿæ¢é™©é—®é¢˜

â€‹	é¢˜è§£ï¼š**æœ€å¤§è´¹ç”¨æœ€å¤§æµ**

â€‹	æ¯ä¸ªç‚¹æ‹†ç‚¹ï¼Œä¸­é—´çš„è¾¹åŒä¸Šé¢˜ï¼Œç›¸é‚»çš„å‡ºç‚¹åˆ°å…¥ç‚¹ï¼ŒSåˆ°(1,1,å…¥)ä¸€æ¡å®¹é‡ä¸ºcarï¼Œè´¹ç”¨ä¸º0çš„è¾¹ï¼Œæœ€åä¸€ä¸ªç‚¹çš„å‡ºç‚¹åˆ°Tå®¹é‡ä¸ºcarï¼Œè´¹ç”¨ä¸º0çš„è¾¹ï¼Œæ±‚æœ€å¤§è´¹ç”¨æœ€å¤§æµã€‚è¾“å‡ºæ–¹æ¡ˆçš„æ—¶å€™åªéœ€è¦DFSä¸€ä¸‹ï¼Œåšå®Œä¸€æ¡æŠŠæµé‡è¿”è¿˜å³å¯ã€‚

## éª‘å£«å…±å­˜é—®é¢˜

â€‹	é¢˜è§£ï¼š**ç½‘ç»œæœ€å°å‰²**

â€‹	é¦–å…ˆé»‘ç™½æŸ“è‰²ï¼Œç„¶åç±»ä¼¼ä¸æ–¹æ ¼æŸ“è‰²å»ºå›¾ï¼Œä¹Ÿå°±æ˜¯å…ˆå‡è®¾å…¨éƒ¨éƒ½é€‰ï¼Œç„¶åå‡å»æœ€å°å‰²å°±æ˜¯ç­”æ¡ˆã€‚





# æ¨¡æ¿

## å¤´æ–‡ä»¶

```c++
//Hello Wolrd
//There is Special Pig Jiong in the world. 
#include<cstdio>
#include<ctype.h>
#include<cstring>
#include<cstdlib>
#include<map>
#include<set>
#include<queue>
#include<cmath>
#include<cstdlib>
#include<algorithm>
using namespace std;
typedef unsigned long long ull;
typedef long long ll;
typedef pair<int,int> pii;
const int inf = 0x3f3f3f3f,oo = inf;
#define pc putchar
#define RG register
char __wzp[1<<15|1],*__S=__wzp+32768;
#define gc() (__S>=__wzp+32768?(__wzp[fread(__wzp,sizeof(char),1<<15,stdin)]=EOF),*((__S=__wzp)++):*(__S++))
inline ll read(){
	RG ll x=0,f=1;RG char c=gc();
	for(;!isdigit(c);c=gc())if(c=='-')f=-1;
	for(;isdigit(c);c=gc())x=(x<<1)+(x<<3)+(c^48);
	return x*f;
}
void write(ll x){
	if(x<0)x=-x,pc('-');
	if(x>=10)write(x/10);
	putchar(x%10+'0');
}
#define rd read
#define mem(x,v) memset(x,v,sizeof(x))
#define pb push_back
#define mp make_pair
#define sqr(x) ((x)*(x))
#define lowbit(x) ((x)&(-(x)))
#define rep(i,a,b) for(RG int i=(a);i<(b);++i)
#define fin(x) {freopen(#x".in","r",stdin);}
#define y1 ________y1
const int N = ;
const int M = ;
int main(){
#define LOCAL 
#ifdef LOCAL
	fin(1);
#endif
	return 0;
}
```

## Dinicæ¨¡æ¿

```c++
//é…åˆTæ¨¡æ¿ä½¿ç”¨ 
#define N ????
#define M ????
struct Edge{
	int to,nxt,cap;
	Edge(){}
	Edge(int to,int nxt,int cap):to(to),nxt(nxt),cap(cap){};
}edge[M*2];
int first[N],cur[N],nume;
void Addedge(int a,int b,int c){
	edge[nume] = Edge(b,first[a],c);first[a] = nume++;
	edge[nume] = Edge(a,first[b],0);first[b] = nume++;
}
int q[N],dis[N],S,T;
bool bfs(){
	int u,v,front,rear;mem(dis,-1);
	for(front=rear=0,dis[u=q[rear++]=T]=1;front<rear;)
		for (int u=q[front++],e=first[u];~e;e=edge[e].nxt)
			if(edge[e^1].cap && !~dis[v=edge[e].to])dis[q[rear++]=v]=dis[u]+1;
	return dis[S]!=-1;
}
int dfs(int u,int flow){
	if(u==T)return flow;
	int used = 0,d,v;
	for (int &e=cur[u];~e;e=edge[e].nxt){
		if(edge[e].cap && dis[v=edge[e].to]==dis[u]-1 && (d = dfs(v,min(flow-used,edge[e].cap))))
			edge[e].cap -= d,edge[e^1].cap += d,used += d;
		if(used == flow) break;
	}
	if(!used)dis[u]=-1;
	return used;
}
int dinic(){
	int ans = 0;
	for(;bfs();ans+=dfs(S,inf))
		rep(i,0,N) cur[i] = first[i];
	return ans;
}
int main(){
	mem(first,-1);nume = 0;
	S = ???,T = ???;
}
```

## SPFAè´¹ç”¨æµæ¨¡æ¿

PSï¼šæœ€å°è´¹ç”¨æœ€å¤§æµ

```c++
//é…åˆTæ¨¡æ¿ä½¿ç”¨ 
#define N 1005 
#define M 20005 
int S,T;
struct Edge{
	int to,nxt,cap,cost;
	Edge(){}
	Edge(int to,int nxt,int cap,int cost):to(to),nxt(nxt),cap(cap),cost(cost){}
}edge[2*M];
int first[N],nume,n,m;
void Addedge(int a,int b,int cap,int cost){
	edge[nume] = Edge(b,first[a],cap,cost);first[a] = nume++;
	edge[nume] = Edge(a,first[b],0,-cost);first[b] = nume++;
}
int dis[N],vis[N],pre[N];
bool spfa(){
	queue<int> q;
	mem(dis,0x3f);
	mem(vis,false);
	mem(pre,-1);
	dis[S]=0;
	vis[S]=true;
	q.push(S);
	while(!q.empty()){
		int u = q.front();q.pop();
		vis[u] = false;
		for (int e=first[u];~e;e=edge[e].nxt){
			int v = edge[e].to;
			if(edge[e].cap&&dis[v]>dis[u]+edge[e].cost){
				dis[v]=dis[u]+edge[e].cost;
				pre[v] = e;
				if(!vis[v]){
					q.push(v);
					vis[v]=true;
				}
			}
		}
	}
	return dis[T]!=inf;
}
int mcmf(){
	int minflow,maxflow=0,mincost=0;
	while(spfa()){
		minflow = inf;
		for(int i=pre[T];~i;i=pre[edge[i^1].to])
			minflow = min(minflow,edge[i].cap);
		for(int i=pre[T];~i;i=pre[edge[i^1].to])
			edge[i].cap -= minflow,
			edge[i^1].cap += minflow;
		mincost += minflow * dis[T];
		maxflow += minflow;
	}
	return mincost;
}
int main(){
	mem(first,-1);nume = 0;
	S = ??,T = ??;
}
```

# éƒ¨åˆ†ä»£ç çš„éƒ¨åˆ†

å‡ºäº~~æ‡’æƒ°~~ç»™å¤§å®¶ç‹¬ç«‹æ€è€ƒçš„ç›®çš„ï¼Œä¸Šé¢å¾ˆå¤šä¸è¯¦ç»†ï¼Œè¿™é‡Œè´´éƒ¨åˆ†ä»£ç ã€‚

ä½†æ˜¯åˆå‡ºäº~~æ‡’æƒ°~~ç¾è§‚ï¼Œåªå¸–éƒ¨åˆ†ä»£ç çš„éƒ¨åˆ†ã€‚

ç¼ºå°‘éƒ¨åˆ†ä¸€èˆ¬ä¸ºå˜é‡å®šä¹‰ï¼ˆè‡ªå·±å†™å§ï¼‰å’Œæœ€å¤§æµï¼ˆæœ€å°å‰²)ï¼Œæˆ–è€…æœ€å°ï¼ˆå¤§ï¼‰è´¹ç”¨æœ€å¤§æµï¼Œè¿™ä¸ªå¾€ä¸Šé¢çœ‹å§ã€‚

## éª‘å£«å…±å­˜é—®é¢˜

```c++
#define encode(a,b) ((a) * (n) + (b) + (1))
int n,m,ans,A[205][205];
const int dx[8]={1,1,-1,-1,2,2,-2,-2};
const int dy[8]={2,-2,2,-2,1,-1,1,-1};
int main(){
	mem(first,-1);nume = 0;
	S = 0,T = n*n+1;
	n = read(),m = rd();
	ans = n*n-m;
	mem(A,false);
	rep(i,0,m){
		int x = rd(),y = rd();
		A[x-1][y-1] = true;
	}
	rep(i,0,n)rep(j,0,n){
		if(A[i][j]) continue;
		if((i+j)&1){
			Addedge(S,encode(i,j),1);
			rep(d,0,8){
				int x = i + dx[d],y = j + dy[d];
				if(x<0||y<0||x>=n||y>=n||A[x][y]) continue;
				Addedge(encode(i,j),encode(x,y),inf);
			}
		}
		else
			Addedge(encode(i,j),T,1);
	}
	printf("%d\n",ans-dinic());
}
```

## ç«æ˜Ÿæ¢é™©é—®é¢˜

```c++
int P,Q,turn[233];
#define encode(a,b) ((a) * (Q) + (b) + 1)
void dfs(int x,int y){
	if(x==P-1&&y==Q-1) return;
	int a=encode(x,y)*2,b=encode(x+1,y)*2-1,c=encode(x,y+1)*2-1;
	if(x==P-1)b=-1;if(y==Q-1)c=-1;
	for(int e=first[a];~e;e=edge[e].nxt){
		if(e&1)continue;
		int v = edge[e].to;
		if(vis[e] >= edge[e^1].cap) continue;
		if(v==b){
			++vis[e];
			turn[++*turn] = 0;
			dfs(x+1,y);
			return ;
		}
		if(v==c){
			++vis[e];
			turn[++*turn] = 1;
			dfs(x,y+1);
			return ;
		}
	}
}
int main(){
	int car = read();
	Q = read(),P = read();
	S = 0,T = P*Q*2+1;
	mem(first,-1);nume = 0;
	Addedge(S,1,car,0);
	Addedge(encode(P-1,Q-1)*2,T,car,0);
	rep(i,0,P)rep(j,0,Q){
		int x = read();
		if(x==0) Addedge(encode(i,j)*2-1,encode(i,j)*2,inf,0); else
		if(x==2) Addedge(encode(i,j)*2-1,encode(i,j)*2,inf,0),
				 Addedge(encode(i,j)*2-1,encode(i,j)*2,1,-1);
		if(i!=P-1)Addedge(encode(i,j)*2,encode(i+1,j)*2-1,inf,0);
		if(j!=Q-1)Addedge(encode(i,j)*2,encode(i,j+1)*2-1,inf,0);
	}
	mcmf();
	mem(vis,0);
	for(int i=1;i<=car;i++){
		turn[0]=0;
		dfs(0,0);
		for(int j=1;j<=turn[0];j++)
			printf("%d %d\n",i,turn[j]);
	} 
	return 0;
}
```

## æ·±æµ·æœºå™¨äººé—®é¢˜

```c++
int pos[233][233];
int main(){
	int tot=0;
	int A=rd(),B=rd(),p=rd(),q=rd();
	mem(first,-1);nume = 0;
	rep(i,0,p+1)rep(j,0,q+1)pos[i][j]=++tot;
	S=tot+1,T=S+1;
	rep(i,0,p+1)rep(j,0,q){
		int x = read();
		Addedge(pos[i][j],pos[i][j+1],1,-x);
		Addedge(pos[i][j],pos[i][j+1],inf,0);
	}
	rep(j,0,q+1)rep(i,0,p){
		int x=read();
		Addedge(pos[i][j],pos[i+1][j],1,-x) ;
		Addedge(pos[i][j],pos[i+1][j],inf,0);
	}
	while(A--){
		int k = rd(),x=rd(),y=rd();
		Addedge(S,pos[x][y],k,0);
	}
	while(B--){
		int k = rd(),x=rd(),y=rd();
		Addedge(pos[x][y],T,k,0);
	}
	printf("%d\n",-mcmf());
	return 0;
}


```

## æ•°å­—æ¢¯å½¢

```c++
int main(){
	m = read(),n = read();
	int tot = 0;
	mem(first,-1);nume = 0;
	S = tot++,T = tot++;
	for(int i=1;i<=n;i++){
		for(int j=1;j<=m+i-1;j++){
			id[i][j][0] = tot++;
			id[i][j][1] = tot++;
			Addedge(id[i][j][0],id[i][j][1],1,-read());
		}
	}
	for(int i=1;i<=n-1;i++){
		for(int j=1;j<=m+i-1;j++){
			Addedge(id[i][j][1],id[i+1][j][0],1,0);
			Addedge(id[i][j][1],id[i+1][j+1][0],1,0);
		} 
	}
	for(int i=1;i<=m;i++)
		Addedge(S,id[1][i][0],1,0);
	for(int i=1;i<=n+m-1;i++){
		Addedge(id[n][i][1],T,inf,0);
	}
	printf("%d\n",-mcmf());
	for(int i=0;i<nume;i+=2) edge[i].cap+=edge[i^1].cap,edge[i^1].cap=0;
	for(int i=1;i<=n;i++){
		for(int j=1;j<=m+i-1;j++){
			int e = pos[id[i][j][0]][id[i][j][1]];
			edge[e].cap = inf;
		}
	}
	printf("%d\n",-mcmf());
	for(int i=0;i<nume;i+=2) edge[i].cap+=edge[i^1].cap,edge[i^1].cap=0;
	for(int i=1;i<=n-1;i++){
		for(int j=1;j<=m+i-1;j++){
			edge[pos[id[i][j][1]][id[i+1][j][0]]].cap = inf;
			edge[pos[id[i][j][1]][id[i+1][j+1][0]]].cap = inf;
		}
	}
	printf("%d\n",-mcmf());
}
```

## æœ€é•¿Kå¯é‡åŒºé—´é›†

```c++
int l[N],y[N*2],r[N],w[N],K;
int main(){
	n = read(),K = read();
	mem(first,-1);nume = 0;
	for(int i=1;i<=n;i++){
		l[i] = read(),r[i] = read();
		if(l[i]>=r[i])swap(l[i],r[i]);
		w[i] = r[i]-l[i];
		y[++*y] = l[i],y[++*y] = r[i];
	} 
	sort(y+1,y+1+*y);
	*y = unique(y+1,y+1+*y) - y - 1;
	for(int i=1;i<=n;i++){
		l[i] = lower_bound(y+1,y+1+*y,l[i]) - y;
		r[i] = lower_bound(y+1,y+1+*y,r[i]) - y;
	}
	S = 0,T = 2**y + 1;
	Addedge(S,1,K,0);
	Addedge(2**y,T,K,0);
	for(int i=1;i<2**y;i++) Addedge(i,i+1,inf,0);
	for(int i=1;i<=n;i++) Addedge(l[i],r[i],1,-w[i]);
	printf("%d\n",-mcmf());
	return 0;
}
```

## èˆªç©ºè·¯çº¿é—®é¢˜

```c++
map<string,int> id;
string name[205];
int main(){
	n = read();m = read();
	mem(first,-1);nume = 0;
	for(int i=1;i<=n;i++){
		string str;
		cin >> str;
		id[str] = i;
		name[i] = str;
	}
	
	S = 1;T = n*2;
	Addedge(1,1+n,2,-1);
	for(int i=2;i<=n-1;i++){
		Addedge(i,i+n,1,-1);
	}
	Addedge(n,n+n,2,-1);
	
	while(m--){
		string str;
		cin >> str;
		int x = id[str];
		cin >> str;
		int y = id[str];
		if(x>y) swap(x,y);
		if(x==1&&y==n)Addedge(x+n,y,2,0);
		else Addedge(x+n,y,1,0);
	}
	
	int ans = mcmf(2);
	if(ans == -1){
		puts("No Solution!");
		return 0;
	}
	printf("%d\n",ans-2);

	cout << name[1] << endl;
	mem(vis,false);
	for(int e=first[n+1],j,k;~e;e=edge[e].nxt){
		if(!edge[e].cap&&!(e&1)){
			k = edge[e].to;
			while(k){
				cout << name[k] << endl;
				vis[k] = true;
				for(j=first[k+n],k=0;~j;j=edge[j].nxt){
					if(!edge[j].cap&&!(j&1)){
						k = edge[j].to;
						break;
					}
				}
			}
			break;
		}
	}
	for(int e=first[n],j,k;~e;e=edge[e].nxt){
		if(!edge[e^1].cap&&(e&1)&&!vis[edge[e].to-n]){
			k = edge[e].to-n;
			while(k){
				cout << name[k] << endl;
				vis[k] = true;
				for(j=first[k],k=0;~j;j=edge[j].nxt){
					if(!edge[j^1].cap&&(j&1)){
						k = edge[j].to - n;
						break;
					}
				}
			}
			break;
		}
	}
	return 0;
}
```

## é¤å·¾è®¡åˆ’

```c++
int n,_P,_M,_F,_N,_S;
void solve(){
	n = read(),_P = read(),_M = read(),_F = read(),_N = read(),_S = read();
	S = 2*n+1,T=S+1,SS=T+1,TT=SS+1;
	mem(first,-1);nume = 0;
	for(int i=1;i<=n;i++){
		Addedge(i+n,TT,inf,0);
		int x = read();
		Addedge(i,i+n,inf-x,0);
		Addedge(i,T,x,0);
		Addedge(S,i+n,x,0);
	}
	for(int i=1;i<=n;i++){
		Addedge(SS,i,inf,_P);
		if(i!=n) Addedge(i,i+1,inf,0);
		if(i+_M<=n) Addedge(i+n,i+_M,inf,_F);
		if(i+_N<=n) Addedge(i+n,i+_N,inf,_S);
	}
	Addedge(TT,SS,inf,0);
	printf("%lld\n",mcmf());
}
int main(){
	solve();
	return 0;
}
```

